<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CYBER-VIBE PROMPT GENERATOR</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --neon-cyan: #00ffff; --neon-magenta: #ff00ff; --bg-dark: #050505; }
        body { background-color: var(--bg-dark); color: var(--neon-cyan); font-family: 'JetBrains Mono', 'Courier New', monospace; padding-bottom: 50px; overflow-x: hidden; }
        .cyber-border { border: 1px solid var(--neon-cyan); box-shadow: 0 0 8px rgba(0, 255, 255, 0.2); }
        .cyber-border-magenta { border: 1px solid var(--neon-magenta); box-shadow: 0 0 8px rgba(255, 0, 255, 0.2); }
        .cyber-border-yellow { border: 1px solid #eab308; box-shadow: 0 0 8px rgba(234, 179, 8, 0.2); }
        .cyber-btn { border: 1px solid var(--neon-cyan); background: transparent; color: var(--neon-cyan); transition: 0.3s; cursor: pointer; }
        .cyber-btn:hover { background: var(--neon-cyan); color: #000; box-shadow: 0 0 15px var(--neon-cyan); }
        .cyber-btn-magenta { border: 1px solid var(--neon-magenta); color: var(--neon-magenta); cursor: pointer; transition: 0.3s;}
        .cyber-btn-magenta:hover { background: var(--neon-magenta); color: #fff; box-shadow: 0 0 15px var(--neon-magenta); }
        .cyber-btn-yellow { border: 1px solid #eab308; color: #eab308; cursor: pointer; transition: 0.3s;}
        .cyber-btn-yellow:hover { background: #eab308; color: #000; box-shadow: 0 0 15px #eab308; }
        .cyber-input { background: #111; border: 1px solid #333; color: #fff; }
        .cyber-input:focus { outline: none; border-color: var(--neon-magenta); }
        .module-card { background: rgba(0,20,20,0.5); transition: transform 0.2s; }
        .module-badge { background: var(--neon-magenta); color: #000; font-weight: bold; padding: 2px 8px; font-size: 10px; border-radius: 4px; }
        
        /* Tabs Style */
        .tab-btn { padding: 12px 24px; font-weight: bold; border: 1px solid #333; color: #666; cursor: pointer; transition: 0.3s; border-bottom: none; border-radius: 8px 8px 0 0; }
        .tab-btn.active { color: var(--neon-cyan); border-color: var(--neon-cyan); background: rgba(0, 255, 255, 0.05); box-shadow: 0 -5px 15px rgba(0,255,255,0.1); }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.4s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Custom Radio */
        .cyber-radio { appearance: none; width: 16px; height: 16px; border: 2px solid var(--neon-cyan); border-radius: 50%; background: transparent; cursor: pointer; position: relative; top: 3px; margin-right: 8px;}
        .cyber-radio:checked { background: var(--neon-magenta); border-color: var(--neon-magenta); box-shadow: 0 0 10px var(--neon-magenta); }

        select { appearance: none; background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2300ffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 1rem center; background-size: 1em; }
    </style>
</head>
<body class="max-w-6xl mx-auto p-6">
	<div class="absolute top-6 right-6 z-50">
        <a href="index_en.html" class="text-xs font-bold text-cyan-400 border border-cyan-400 px-3 py-1 rounded hover:bg-cyan-400 hover:text-black transition-colors duration-300" style="box-shadow: 0 0 5px rgba(0, 255, 255, 0.3);">
            ğŸŒ English
        </a>
    </div>
    <header class="mb-6 text-center pb-4">
        <h1 class="text-4xl font-black italic tracking-widest mb-2" style="text-shadow: 2px 2px var(--neon-magenta);">CYBER-VIBE PROMPT GENERATOR</h1>
        <div id="statusIndicator" class="text-xs text-yellow-500 animate-pulse">SYSTEM_BOOTING: æ­£åœ¨é€£ç·šè‡³è³‡æ–™åº«...</div>
    </header>

	<div class="flex justify-center border-b border-gray-800 mb-8 space-x-2">
		<button class="tab-btn" onclick="switchTab('tab-env')">ğŸ”§ ç’°å¢ƒå»ºç½® (ENV_SETUP)</button>
        <button class="tab-btn active" onclick="switchTab('tab-generator')">ğŸ§™â€â™‚ï¸ å’’èªç·¨è­¯å™¨ (PROMPT_GEN)</button>
        <button class="tab-btn" onclick="switchTab('tab-docs')">ğŸ“š æ–‡ç»èˆ‡æ¢ç´¢å·¥å…· (DOCS & EXPLORER)</button>   
    </div>

    <div id="tab-generator" class="tab-content active">
        
        <div class="mb-8 p-6 cyber-border-magenta bg-black relative">
            <h2 class="text-xl font-bold mb-4 text-magenta-500 flex items-center">ğŸ” æ™ºæ…§å…¨å±€æœå°‹ (SMART_SEARCH)</h2>
            <input type="text" id="globalSearch" class="w-full p-4 cyber-input text-lg text-cyan-300 mb-2" placeholder="è¼¸å…¥é—œéµå­— (ä¾‹å¦‚ï¼šæ¿¾æ³¢ã€è¿´åœˆã€OpenCV)..." onkeyup="performSearch()">
            <div id="searchResults" class="grid grid-cols-1 md:grid-cols-2 gap-2 max-h-48 overflow-y-auto"></div>
        </div>
		
        <div class="mb-8 p-6 cyber-border-yellow bg-black relative">
            <h2 class="text-xl font-bold mb-4 text-yellow-500 flex items-center">
                <span class="mr-2">âš¡</span> å¿«é€Ÿé€£çºŒæŠ€ (Combo Presets)
            </h2>
            <p class="text-sm text-gray-400 mb-4">æ‡¶å¾—æ…¢æ…¢ç–ŠåŠ æ¨¡çµ„ï¼Ÿç›´æ¥é¸æ“‡å¸¸ç”¨çš„å®Œæ•´é€£æ®µï¼Œä¸€éµç”¢ç”Ÿæç¤ºè©ï¼</p>
            <div class="flex flex-col md:flex-row gap-4">
				<select id="comboSelect" class="flex-grow p-3 cyber-input text-sm text-yellow-300">
                    <option value="">-- è«‹é¸æ“‡ Combo é€£çºŒæŠ€ --</option>
                    </select>
                <button onclick="applyCombo()" class="cyber-btn-yellow px-8 py-3 font-bold whitespace-nowrap">å¥—ç”¨é€£çºŒæŠ€</button>
            </div>
        </div>

        <div class="mb-8 p-6 cyber-border">
            <h2 class="text-xl font-bold mb-4 text-magenta-500">STEP 1: é¸æ“‡ AI è§’è‰²å‰ç½®è©</h2>
            <select id="prefixSelect" class="w-full p-3 cyber-input text-cyan-400">
                <option value="ä½ ç¾åœ¨æ˜¯ä¸€ä½è³‡æ·±çš„ Python è»Ÿé«”å·¥ç¨‹å¸«ã€‚è«‹å®Œæˆä»¥ä¸‹éœ€æ±‚ï¼Œä¸¦åŠ ä¸Šè©³ç´°ä¸­æ–‡è¨»è§£ï¼š">ã€ä¸­æ–‡ - è³‡æ·±æ¶æ§‹å¸«ã€‘</option>
                <option value="è«‹æ‰®æ¼”é‹å‹•ç§‘å­¸èˆ‡è¨Šè™Ÿè™•ç†å°ˆå®¶ã€‚ä½¿ç”¨ NumPy, Pandas å’Œ SciPy å®Œæˆæ•¸æ“šè™•ç†ï¼š">ã€ä¸­æ–‡ - è¨Šè™Ÿè™•ç†å°ˆå®¶ã€‘</option>
                <option value="æˆ‘æ˜¯ä¸€ä½ Python åˆå­¸è€…ï¼Œè«‹å¯«å‡ºç¨‹å¼ç¢¼ä¸¦é€è¡Œç™½è©±è§£é‡‹é‹ä½œåŸç†ï¼š">ã€ä¸­æ–‡ - æ–°æ‰‹æ•™å­¸æ¨¡å¼ã€‘</option>
            </select>
        </div>

        <div class="mb-4 flex justify-between items-end">
            <h2 class="text-xl font-bold text-magenta-500">STEP 2: ç–ŠåŠ å’’èªæ¨¡çµ„ (å¯æ’åºç·¨è™Ÿ)</h2>
            <button onclick="addModule()" class="cyber-btn px-4 py-2 text-sm font-bold">+ æ–°å¢ç©ºç™½æ¨¡çµ„</button>
        </div>
        
        <div id="modulesContainer" class="space-y-4 mb-8"></div>

        <div class="p-6 cyber-border bg-black">
            <h2 class="text-xl font-bold mb-4 text-magenta-500">STEP 3: ä¿®æ”¹ç­–ç•¥èˆ‡ç·¨è­¯</h2>
            
            <div class="mb-6 p-5 border border-gray-700 bg-gray-900 rounded">
                <h3 class="text-yellow-400 font-bold mb-4 text-sm">ğŸ› ï¸ ç¨‹å¼ç¢¼ä¿®æ”¹ç­–ç•¥ (Modification Strategy)</h3>
                <div class="space-y-3 text-sm text-gray-300">
                    <label class="flex items-center cursor-pointer"><input type="radio" name="modStrategy" value="default" class="cyber-radio" checked onchange="toggleCustomInput()"><span>ğŸ†• å…¨æ–°ç”Ÿæˆ (New Project)</span></label>
                    <label class="flex items-center cursor-pointer"><input type="radio" name="modStrategy" value="small" class="cyber-radio" onchange="toggleCustomInput()"><span>ğŸŸ¢ å±€éƒ¨å¾®èª¿ (åƒ…æä¾›ä¿®æ”¹ç‰‡æ®µèˆ‡æ”¾ç½®ä½ç½®)</span></label>
                    <label class="flex items-center cursor-pointer"><input type="radio" name="modStrategy" value="large" class="cyber-radio" onchange="toggleCustomInput()"><span>ğŸ”´ å¤§ç¯„åœé‡æ§‹ (æä¾›å®Œæ•´æ–°ç¨‹å¼ç¢¼)</span></label>
                    <label class="flex items-center cursor-pointer"><input type="radio" name="modStrategy" value="attached" class="cyber-radio" onchange="toggleCustomInput()"><span>ğŸ“ ä¾æœ€æ–°é™„æª”ä¿®æ”¹ (ä¾æ“šä¸Šå‚³æª”æ¡ˆé€²è¡Œå¾®èª¿)</span></label>
                    <label class="flex items-center cursor-pointer"><input type="radio" name="modStrategy" value="custom" class="cyber-radio" onchange="toggleCustomInput()"><span>âœï¸ è‡ªè¨‚æŒ‡ä»¤ (ä¾‹å¦‚ï¼šè«‹å°‡ #02 æ”¾å…¥ #01 å…§)</span></label>
                </div>
                <textarea id="customStrategyInput" class="hidden w-full mt-4 p-3 cyber-input text-sm text-yellow-300" rows="3" placeholder="è«‹åœ¨æ­¤è¼¸å…¥è‡ªè¨‚ prompt æŒ‡ä»¤..."></textarea>
            </div>

            <button onclick="generateFinalPrompt()" class="cyber-btn-magenta w-full py-3 font-bold text-lg mb-4">>>> å•Ÿå‹•ç·¨è­¯ (GENERATE) <<<</button>
            <textarea id="finalOutput" class="w-full h-64 p-4 cyber-input text-green-400 font-mono text-sm leading-relaxed mb-4"></textarea>
            <button onclick="copyFinal()" class="cyber-btn w-full py-3 font-bold">è¤‡è£½å®Œæ•´å’’èª (COPY)</button>
        </div>
    </div>

    <div id="tab-docs" class="tab-content">
        <div class="mb-8 p-6 cyber-border-yellow bg-black">
            <h2 class="text-xl font-bold mb-2 text-yellow-500">ğŸ“¡ Python å‡½å¼åº«é›·é”æ¢æ¸¬å™¨</h2>
            <div class="flex flex-col md:flex-row gap-4 mt-4">
                <input type="text" id="explorer-module-name" class="flex-grow p-3 cyber-input text-yellow-300" placeholder="å¥—ä»¶åç¨± (ä¾‹å¦‚: scipy.signal)" value="scipy.signal">
                <button onclick="downloadExplorerPy()" class="cyber-btn-yellow px-8 py-3 font-bold">â¬‡ï¸ ä¸‹è¼‰æ¢æ¸¬è…³æœ¬</button>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-magenta-500 mb-2">SciPy</h3>
                <input type="text" id="search-scipy" class="w-full p-2 cyber-input mb-4" placeholder="ä¾‹å¦‚: filtfilt">
                <button onclick="searchDocs('scipy', 'docs.scipy.org/doc/scipy/reference/')" class="cyber-btn w-full py-2">ğŸ” æœå°‹</button>
            </div>
            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-magenta-500 mb-2">Pandas</h3>
                <input type="text" id="search-pandas" class="w-full p-2 cyber-input mb-4" placeholder="ä¾‹å¦‚: read_csv">
                <button onclick="searchDocs('pandas', 'pandas.pydata.org/docs/reference/')" class="cyber-btn w-full py-2">ğŸ” æœå°‹</button>
            </div>
            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-magenta-500 mb-2">OpenCV</h3>
                <input type="text" id="search-opencv" class="w-full p-2 cyber-input mb-4" placeholder="ä¾‹å¦‚: cvtColor">
                <button onclick="searchDocs('opencv', 'docs.opencv.org/4.x/')" class="cyber-btn w-full py-2">ğŸ” æœå°‹</button>
            </div>
			<div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-magenta-500 mb-2">Scikit-Learn</h3>
                <input type="text" id="search-sklearn" class="w-full p-2 cyber-input mb-4" placeholder="ä¾‹å¦‚: RandomForest">
                <button onclick="searchDocs('sklearn', 'scikit-learn.org/stable/modules/')" class="cyber-btn w-full py-2">ğŸ” æœå°‹</button>
            </div>

            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-magenta-500 mb-2">Plotly</h3>
                <input type="text" id="search-plotly" class="w-full p-2 cyber-input mb-4" placeholder="ä¾‹å¦‚: px.scatter">
                <button onclick="searchDocs('plotly', 'plotly.com/python/')" class="cyber-btn w-full py-2">ğŸ” æœå°‹</button>
            </div>

            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-magenta-500 mb-2">Flet (UI)</h3>
                <input type="text" id="search-flet" class="w-full p-2 cyber-input mb-4" placeholder="ä¾‹å¦‚: ElevatedButton">
                <button onclick="searchDocs('flet', 'flet.dev/docs/controls/')" class="cyber-btn w-full py-2">ğŸ” æœå°‹</button>
            </div>
            
            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-magenta-500 mb-2">Pygame</h3>
                <input type="text" id="search-pygame" class="w-full p-2 cyber-input mb-4" placeholder="ä¾‹å¦‚: display.set_mode">
                <button onclick="searchDocs('pygame', 'pygame.org/docs/')" class="cyber-btn w-full py-2">ğŸ” æœå°‹</button>
            </div>
            
            <div class="p-6 cyber-border bg-gray-900 md:col-span-2 lg:col-span-3">
                <h3 class="font-bold text-cyan-500 mb-2">Stack Overflow / ç¶œåˆè§£é¡Œ</h3>
                <input type="text" id="search-general" class="w-full p-2 cyber-input mb-4" placeholder="é‡åˆ°æœªçŸ¥çš„å ±éŒ¯è¨Šæ¯ï¼Ÿç›´æ¥è²¼åˆ°é€™è£¡...">
                <button onclick="searchDocs('general', 'stackoverflow.com')" class="cyber-btn-magenta w-full py-2">ğŸŒ æœå°‹ Stack Overflow è§£æ±ºæ–¹æ¡ˆ</button>
            </div>
        </div>
    </div>

    <div id="tab-env" class="tab-content">
        <div class="mb-8 text-center">
            <h2 class="text-3xl font-bold text-cyan-400 mb-2">ENVIRONMENT SETUP</h2>
            <p class="text-gray-400">æ–°æ‰‹å°ˆå€ï¼šå®‰è£ Miniconda ä¸¦ä¸€éµå»ºç«‹å°ˆå±¬é–‹ç™¼ç’°å¢ƒã€‚</p>
        </div>

        <div class="mb-8 p-6 cyber-border-magenta bg-black">
            <h2 class="text-xl font-bold mb-2 text-magenta-500 flex items-center">
                <span class="mr-2">ğŸ“„</span> æ­¥é©Ÿ 0ï¼šç·¨è¼¯ä¸¦ä¸‹è¼‰ç’°å¢ƒè¨­å®šæª” (vibe_sport.yml)
            </h2>
            <p class="text-sm text-gray-400 mb-4">æ‚¨å¯ä»¥ç›´æ¥åœ¨ä¸‹æ–¹æ–‡å­—æ¡†å…§ä¿®æ”¹ã€æ–°å¢æˆ–åˆªé™¤éœ€è¦çš„å¥—ä»¶ã€‚ç¢ºèªç„¡èª¤å¾Œé»æ“Šä¸‹è¼‰ã€‚</p>
            <div class="flex justify-center">
                <button onclick="downloadEnvYml()" class="cyber-btn-magenta px-8 py-3 font-bold tracking-wider w-full">â¬‡ï¸ é»æ“Šç”¢ç”Ÿä¸¦ä¸‹è¼‰ vibe_sport.yml</button>
            </div>
            <textarea id="ymlEditor" class="mt-4 p-4 bg-gray-900 border border-gray-700 rounded text-xs text-green-400 font-mono w-full h-48 focus:outline-none focus:border-cyan-500" spellcheck="false">
name: vibe_sport
channels:
  - conda-forge
  - defaults
dependencies:
  - python=3.10
  - spyder
  - spyder-kernels
  - numpy
  - pandas
  - scipy
  - matplotlib
  - seaborn
  - scikit-learn
  - openpyxl
  - pip
  - pip:
      - plotly
      - pingouin
      - moviepy
      - opencv-python
      - mediapipe
      - customtkinter
      - pyinstaller
      - pyserial
      - bleak
      - playwright
      - beautifulsoup4
      - librosa
      - tqdm</textarea>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-lg text-cyan-400 mb-2">STEP 1: ä¸‹è¼‰ Miniconda</h3>
                <p class="text-gray-400 text-sm">è«‹å‰å¾€å®˜ç¶²ä¸‹è¼‰é©ç”¨æ–¼æ‚¨ä½œæ¥­ç³»çµ±çš„ Miniconda å®‰è£æª” (å»ºè­°é¸æ“‡ Python 3.10 ä»¥ä¸Šç‰ˆæœ¬)ã€‚</p>
                <a href="https://docs.anaconda.com/miniconda/" target="_blank" class="block mt-4 text-center border border-cyan-500 text-cyan-500 hover:bg-cyan-500 hover:text-black py-2 transition text-sm">ğŸ”— å‰å¾€ Miniconda å®˜ç¶²</a>
            </div>
            
            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-lg text-cyan-400 mb-2">STEP 2: å®‰è£ Miniconda</h3>
                <p class="text-gray-400 text-sm">åŸ·è¡Œå®‰è£æª”ã€‚å»ºè­°è¨­å®šå¦‚ä¸‹ï¼š<br>1. é¸æ“‡ <b>Just Me</b>ã€‚<br>2. å®‰è£è·¯å¾‘ä¿æŒé è¨­ã€‚<br>3. <b>ä¸éœ€å‹¾é¸</b> Add to PATH (ç¶­æŒé è¨­å³å¯)ã€‚<br>4. å‹¾é¸ Register Miniconda as my default Pythonã€‚</p>
            </div>

            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-lg text-cyan-400 mb-2">STEP 3: æ”¾ç½®è¨­å®šæª”</h3>
                <p class="text-gray-400 text-sm">è«‹å°‡ä¸Šæ–¹ä¸‹è¼‰çš„ <code class="text-magenta-400 bg-gray-900 px-1">vibe_sport.yml</code>ï¼Œæ”¾åœ¨æ‚¨çš„ä½¿ç”¨è€…è³‡æ–™å¤¾ <code class="text-yellow-300 bg-gray-900 px-1">C:\Users\æ‚¨çš„åå­—</code> (å¦‚æœæ”¾åœ¨æ¡Œé¢ï¼Œä¸‹ä¸€æ­¥çµ‚ç«¯æ©Ÿéœ€å…ˆè¼¸å…¥ cd Desktop åˆ‡æ›è·¯å¾‘)ã€‚</p>
            </div>

            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-lg text-cyan-400 mb-2">STEP 4: é–‹å•Ÿçµ‚ç«¯æ©Ÿ</h3>
                <p class="text-gray-400 text-sm">åœ¨ Windows å·¦ä¸‹è§’æœå°‹åˆ—è¼¸å…¥ä¸¦æ‰“é–‹ <code class="text-yellow-300 bg-gray-900 px-1">Anaconda Prompt (Miniconda3)</code> (é»‘åº•ç™½å­—çš„è¦–çª—)ã€‚</p>
            </div>

            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-lg text-cyan-400 mb-2">STEP 5: å»ºç«‹èˆ‡å•Ÿå‹•ç’°å¢ƒ</h3>
                <p class="text-gray-400 text-sm">åœ¨é»‘è¦–çª—ä¸­è¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤å»ºç«‹ç’°å¢ƒ (éœ€ç­‰å¾…ä¸€æ®µæ™‚é–“ä¸‹è¼‰å¥—ä»¶)ï¼š</p>
                <div class="mt-2 p-2 bg-gray-900 border border-gray-700 text-green-400 font-mono text-xs select-all cursor-pointer">
                    conda env create -f vibe_sport.yml
                </div>
                <p class="text-gray-400 text-sm mt-2">å®Œæˆå¾Œå•Ÿå‹•ç’°å¢ƒï¼š</p>
                <div class="mt-1 p-2 bg-gray-900 border border-gray-700 text-green-400 font-mono text-xs select-all cursor-pointer">
                    conda activate vibe_sport
                </div>
            </div>

            <div class="p-6 cyber-border bg-black">
                <h3 class="font-bold text-lg text-cyan-400 mb-2">STEP 6: é–‹å•Ÿ Spyder</h3>
                <p class="text-gray-400 text-sm">ç¢ºä¿çµ‚ç«¯æ©Ÿå·¦å´æ‹¬è™Ÿé¡¯ç¤º <span class="text-yellow-300">(vibe_sport)</span> å¾Œï¼Œè¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤å³å¯å•Ÿå‹•é–‹ç™¼ç’°å¢ƒï¼</p>
                <div class="mt-2 p-3 bg-gray-900 border border-gray-700 text-green-400 font-mono text-sm select-all cursor-pointer">
                    spyder
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbz94YXoKDBo88MwYvW5cCLnib4CVkcUdy9WP4RUJ9zft5VO4jv73DBZou8_ImCZlWX5IQ/exec"; 
        let sheetData = [];
        let categoryMap = {};

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }
		
		// è² è²¬ä¸‹è¼‰ yaml æª”æ¡ˆçš„å‡½å¼
        function downloadEnvYml() {
            // å¾å¯ç·¨è¼¯çš„ textarea ä¸­æŠ“å–ä½¿ç”¨è€…ç¢ºèªå¾Œçš„ yaml å…§å®¹
            const ymlContent = document.getElementById('ymlEditor').value;
            const blob = new Blob([ymlContent], { type: "text/yaml;charset=utf-8" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "vibe_sport.yml";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function toggleCustomInput() {
            const strategy = document.querySelector('input[name="modStrategy"]:checked').value;
            document.getElementById('customStrategyInput').classList.toggle('hidden', strategy !== 'custom');
        }

        async function init() {
            try {
				const response = await fetch(API_URL);
                sheetData = await response.json();
                
                const comboSelect = document.getElementById('comboSelect');
                
                sheetData.forEach(row => {
                    const cat = row["ä¸»è¦åˆ†é¡"];
                    if (cat) {
                        // åˆ¤æ–·ï¼šå¦‚æœæ˜¯ Comboï¼Œå°±å°‡å®ƒåŠ å…¥ä¸Šæ–¹å¿«é€Ÿé€£çºŒæŠ€çš„é¸å–®
                        if (cat.trim() === "Comboé€£çºŒæŠ€") {
                            const comboName = row["é—œéµå­— (Tags)"] || "æœªå‘½å Combo";
                            const comboPrompt = row["Vibe å’’èª (Prompt)"] || "";
                            if (comboPrompt) {
                                // å°‡ Combo çš„å’’èªä½œç‚º valueï¼Œé—œéµå­—ä½œç‚ºé¡¯ç¤ºåç¨±
                                comboSelect.insertAdjacentHTML('beforeend', `<option value="${comboPrompt}">${comboName}</option>`);
                            }
                        } 
                        // å¦å‰‡ï¼Œå°‡å…¶æ­¸é¡åˆ°ä¸€èˆ¬çš„æ¨¡çµ„åˆ†é¡åº«ä¸­
                        else {
                            if (!categoryMap[cat]) categoryMap[cat] = [];
                            categoryMap[cat].push(row);
                        }
                    }
                });
                
                document.getElementById('statusIndicator').innerText = `SYSTEM_ONLINE / è¼‰å…¥ ${sheetData.length} ç­†è³‡æ–™`;
                document.getElementById('statusIndicator').className = "text-xs text-green-500";
                addModule();
            } catch (e) {
                document.getElementById('statusIndicator').innerText = "é€£ç·šå¤±æ•—";
            }
        }

        function refreshModuleNumbers() {
            const modules = document.querySelectorAll('.module-card');
            modules.forEach((mod, index) => {
                const num = (index + 1).toString().padStart(2, '0');
                mod.querySelector('.module-id-label').innerText = `#${num}`;
            });
        }

        window.addModule = function() {
            const container = document.getElementById('modulesContainer');
            const moduleId = 'mod_' + Date.now();
            let catOptions = `<option value="">-- é¸æ“‡åˆ†é¡ --</option>`;
            for (let cat in categoryMap) catOptions += `<option value="${cat}">${cat}</option>`;

            const moduleHTML = `
                <div id="${moduleId}" class="module-card cyber-border p-4 relative mb-4">
                    <div class="flex justify-between items-center mb-3">
                        <span class="module-badge">MODULE <span class="module-id-label">#00</span></span>
                        <div class="flex space-x-2">
                            <button onclick="moveUp('${moduleId}')" class="text-cyan-500 px-2 hover:bg-cyan-900 rounded">â–²</button>
                            <button onclick="moveDown('${moduleId}')" class="text-cyan-500 px-2 hover:bg-cyan-900 rounded">â–¼</button>
                            <button onclick="deleteModule('${moduleId}')" class="text-red-500 px-2 hover:bg-red-900 rounded">âœ–</button>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <select class="main-cat w-full p-2 cyber-input text-xs" onchange="updateSubCat('${moduleId}')">${catOptions}</select>
                        <select class="sub-cat w-full p-2 cyber-input text-xs" onchange="updateDetails('${moduleId}')"><option value="">-- é—œéµå­— --</option></select>
                    </div>
                    <div class="mt-4 text-xs">
                        <span class="intent-text text-yellow-300 block mb-1">...</span>
                        <code class="func-text text-green-300">...</code>
                    </div>
                    <div class="param-container hidden mt-2 bg-gray-900 p-2 border border-dashed border-magenta-500">
                        <span class="param-hint text-[10px] text-gray-400 block mb-1"></span>
                        <input type="text" class="param-input w-full p-2 cyber-input text-xs text-yellow-300">
                    </div>
                    <textarea class="prompt-data hidden"></textarea>
                </div>`;
            container.insertAdjacentHTML('beforeend', moduleHTML);
            refreshModuleNumbers();
            return moduleId;
        };

        window.updateSubCat = function(id) {
            const mod = document.getElementById(id);
            const mainCat = mod.querySelector('.main-cat').value;
            const subSelect = mod.querySelector('.sub-cat');
            subSelect.innerHTML = '<option value="">-- é—œéµå­— --</option>';
            if (categoryMap[mainCat]) {
                categoryMap[mainCat].forEach((item, idx) => {
                    subSelect.insertAdjacentHTML('beforeend', `<option value="${idx}">${item["é—œéµå­— (Tags)"]}</option>`);
                });
            }
        };

		window.updateDetails = function(id) {
            const mod = document.getElementById(id);
            const mainCat = mod.querySelector('.main-cat').value;
            const subIdx = mod.querySelector('.sub-cat').value;
            if (subIdx === "") return;
            
            const data = categoryMap[mainCat][subIdx];
            
            const targetFunc = data["å°æ‡‰å¥—ä»¶/å‡½å¼"] || data["å°æ‡‰ Scipy å‡½å¼"] || "N/A";
            const userIntent = data["å­¸ç”Ÿé‡åˆ°çš„ç‹€æ³ (User Intent)"] || "ç„¡æè¿°";
            const vibePrompt = data["Vibe å’’èª (Prompt)"] || "";
            const paramField = data["åƒæ•¸å¡«ç©º"] || "";

            mod.querySelector('.intent-text').innerText = userIntent.split(" / ")[0];
            mod.querySelector('.func-text').innerText = targetFunc;
            mod.querySelector('.prompt-data').value = vibePrompt;

            const pc = mod.querySelector('.param-container');
            if (paramField && !paramField.includes("ç„¡") && !paramField.includes("None")) {
                pc.classList.remove('hidden');
                mod.querySelector('.param-hint').innerText = paramField;
            } else { 
                pc.classList.add('hidden'); 
            }
        };

        window.deleteModule = function(id) { document.getElementById(id).remove(); refreshModuleNumbers(); };
        window.moveUp = function(id) { const el = document.getElementById(id); if (el.previousElementSibling) { el.parentNode.insertBefore(el, el.previousElementSibling); refreshModuleNumbers(); } };
        window.moveDown = function(id) { const el = document.getElementById(id); if (el.nextElementSibling) { el.parentNode.insertBefore(el.nextElementSibling, el); refreshModuleNumbers(); } };

        window.generateFinalPrompt = function() {
            const prefix = document.getElementById('prefixSelect').value;
            const strategy = document.querySelector('input[name="modStrategy"]:checked').value;
            const modules = document.querySelectorAll('.module-card');
            let finalString = prefix + "\n\n";
            let count = 0;

            modules.forEach((mod, index) => {
                const num = (index + 1).toString().padStart(2, '0');
                const prompt = mod.querySelector('.prompt-data').value;
                const paramValue = mod.querySelector('.param-input').value.trim();
                if (prompt) {
                    const isEnd = paramValue.includes("çµæŸ") || paramValue.toLowerCase().includes("end");
                    if (isEnd) {
                        finalString += `[Module #${num}] ğŸ›‘ é‚è¼¯çµæŸé» (Scope End)ï¼š\nä½¿ç”¨è€…æŒ‡å®šï¼š${paramValue}ã€‚è«‹åœ¨æ­¤è™•ç²¾ç¢ºé—œé–‰å°æ‡‰çš„ç¸®æ’å±¤ç´šã€‚\n--------------------\n`;
                    } else {
                        finalString += `[Module #${num}]\n${prompt}${paramValue ? "\n(è¨­å®šåƒæ•¸ï¼š" + paramValue + ")" : ""}\n--------------------\n`;
                    }
                    count++;
                }
            });

            const strictRule = "è«‹åš´æ ¼ä¿æŒåŸå§‹æ¶æ§‹æ’ç‰ˆã€è®Šæ•¸å‘½åèˆ‡ UI è¨­è¨ˆã€‚åªé€²è¡Œå±€éƒ¨å¾®èª¿ï¼Œç¦æ­¢æ“…è‡ªé‡æ§‹ã€‚";
            if (strategy === 'small') finalString += `\nã€ç­–ç•¥ï¼šå±€éƒ¨å¾®èª¿ã€‘\nè«‹åƒ…æä¾›ä¿®æ”¹ç‰‡æ®µèˆ‡æ”¾ç½®ä½ç½®ã€‚æŒ‡å¼•ï¼š${strictRule}`;
            else if (strategy === 'large') finalString += `\nã€ç­–ç•¥ï¼šå¤§ç¯„åœé‡æ§‹ã€‘\nè«‹æä¾›å®Œæ•´ä¸”æ­£ç¢ºçš„æ–°ç¨‹å¼ç¢¼ã€‚æŒ‡å¼•ï¼š${strictRule}`;
            else if (strategy === 'attached') finalString += `\nã€ç­–ç•¥ï¼šä¾é™„æª”ä¿®æ”¹ã€‘\nè«‹åŸºæ–¼æˆ‘æœ€æ–°ä¸Šå‚³çš„é™„ä»¶é€²è¡Œä¿®æ”¹ã€‚æŒ‡å¼•ï¼š${strictRule}`;
            else if (strategy === 'custom') finalString += `\nã€ç­–ç•¥ï¼šè‡ªè¨‚è¦å‰‡ã€‘\n${document.getElementById('customStrategyInput').value}`;

            document.getElementById('finalOutput').value = finalString;
        };

		// åŸ·è¡Œ Combo é€£çºŒæŠ€çš„å‡½å¼
        window.applyCombo = function() {
            const comboText = document.getElementById('comboSelect').value;
            if (!comboText) {
                alert("è«‹å…ˆåœ¨ä¸‹æ‹‰é¸å–®é¸æ“‡ä¸€å€‹ Combo é€£çºŒæŠ€ï¼");
                return;
            }
            
            const prefix = document.getElementById('prefixSelect').value;
            const finalString = prefix + 
                "\n\n====================\nã€âš¡ å¿«é€Ÿé€£çºŒæŠ€ (Combo)ã€‘\n" + 
                comboText + 
                "\n\n====================\nã€ğŸ›¡ï¸ æ¶æ§‹ä¿è­·æŒ‡ä»¤ã€‘\nè«‹åš´æ ¼ä¿æŒåŸå§‹æ¶æ§‹æ’ç‰ˆã€è®Šæ•¸å‘½åèˆ‡ UI è¨­è¨ˆã€‚åªé€²è¡Œå±€éƒ¨å¾®èª¿ï¼Œç¦æ­¢æ“…è‡ªé‡æ§‹ã€‚";
            
            document.getElementById('finalOutput').value = finalString;
            document.getElementById('finalOutput').scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            const outputBox = document.getElementById('finalOutput');
            outputBox.style.animation = "flash-border 0.5s 2";
            setTimeout(() => { outputBox.style.animation = ""; }, 1000);
        };

        window.copyFinal = function() {
            const out = document.getElementById('finalOutput');
            out.select();
            document.execCommand('copy');
            alert("å·²è¤‡è£½ï¼");
        };

        function performSearch() {
            const query = document.getElementById('globalSearch').value.toLowerCase().trim();
            const res = document.getElementById('searchResults');
            res.innerHTML = '';
            if (!query) return;
            let matches = [];
            for (let cat in categoryMap) {
                categoryMap[cat].forEach((item, idx) => {
                    if (JSON.stringify(item).toLowerCase().includes(query)) matches.push({ cat, idx, item });
                });
            }
            matches.slice(0, 8).forEach(m => {
                const btn = document.createElement('button');
                btn.className = "text-left p-2 border border-gray-800 bg-gray-900 hover:border-cyan-400 text-xs";
                btn.innerHTML = `<span class="text-magenta-400 font-bold">${m.item["é—œéµå­— (Tags)"]}</span><br><span class="text-gray-500">${m.item["ä¸»è¦åˆ†é¡"]}</span>`;
                btn.onclick = () => {
                    const id = addModule();
                    const mod = document.getElementById(id);
                    mod.querySelector('.main-cat').value = m.cat;
                    updateSubCat(id);
                    mod.querySelector('.sub-cat').value = m.idx;
                    updateDetails(id);
                    res.innerHTML = '';
                    document.getElementById('globalSearch').value = '';
                };
                res.appendChild(btn);
            });
        }

        function downloadExplorerPy() {
            let m = document.getElementById('explorer-module-name').value.trim().toLowerCase();
            const py = `import importlib, inspect, pandas as pd, os\ndef explore(n):\n try:\n  mod=importlib.import_module(n)\n  data=[{"Type": "Func" if inspect.isfunction(o) else "Class", "Name": k, "Doc": (inspect.getdoc(o) or "").split("\\n")[0]} for k,o in inspect.getmembers(mod) if not k.startswith("_")]\n  df=pd.DataFrame(data)\n  fn=f"{n.replace('.','_')}_dict.csv"\n  df.to_csv(fn, encoding="utf-8-sig", index=False)\n  print(f"âœ… Saved to: {fn}")\n except Exception as e: print(e)\nexplore("${m}")`;
            const blob = new Blob([py], { type: "text/plain" });
            const a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = `explore_${m}.py`;
            a.click();
        }

        function searchDocs(id, url) {
            const q = document.getElementById('search-' + id).value;
            window.open(`https://www.google.com/search?q=site:${url}+${q}`, '_blank');
        }

        init();
    </script>
</body>

</html>

